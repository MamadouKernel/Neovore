@model Neovore.Web.Domain.Entities.SiteSettings
@{
    ViewData["Title"] = "Paramètres du site";
}
<div class="page-header">
  <h1 class="page-title">Paramètres du site</h1>
  <p class="page-subtitle">Configurer les informations générales du site</p>
</div>

@if (ViewBag.Message != null)
{
  <div class="alert alert-success alert-dismissible fade show" role="alert">
    <i class="bi bi-check-circle me-2"></i>@ViewBag.Message
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
}

<div class="admin-card">
  <div class="card-body p-4">
    <form method="post" enctype="multipart/form-data">
      @Html.AntiForgeryToken()

      <div class="row g-4">
        <div class="col-12">
          <h3 class="h5 fw-bold mb-3">
            <i class="bi bi-building me-2" style="color: #FF6B35;"></i>Informations de l'entreprise
          </h3>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Nom de l'entreprise *</label>
          <input asp-for="NomEntreprise" class="form-control" placeholder="NÉOVORE" required />
          <span asp-validation-for="NomEntreprise" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-image me-2"></i>Logo du site
          </label>
          <input type="file" name="logoFile" accept="image/*" class="form-control" />
          <small class="text-muted">Formats acceptés : JPG, PNG, GIF, WebP. Laisser vide pour conserver le logo actuel.</small>
          @if (!string.IsNullOrEmpty(Model.LogoUrl))
          {
            <div class="mt-2">
              <p class="small mb-1">Logo actuel :</p>
              <img src="@Model.LogoUrl" alt="Logo actuel" style="max-height: 80px; max-width: 200px; border: 1px solid #ddd; border-radius: 4px; padding: 4px;" />
            </div>
          }
          <span asp-validation-for="LogoUrl" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Email de contact</label>
          <input asp-for="EmailContact" type="email" class="form-control" placeholder="contact@example.com" />
          <span asp-validation-for="EmailContact" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Téléphone</label>
          <input asp-for="TelephoneContact" class="form-control" placeholder="+33 X XX XX XX XX" />
          <span asp-validation-for="TelephoneContact" class="text-danger small"></span>
        </div>

        <div class="col-12">
          <label class="form-label fw-bold">
            <i class="bi bi-geo-alt me-2"></i>Adresse
          </label>
          <input asp-for="Adresse" class="form-control" placeholder="Rue, quartier, commune (ex: 2 plateaux, Cocody, Abidjan)" />
          <div class="form-text">
            <i class="bi bi-info-circle me-1"></i>
            <strong>Important :</strong> Ce champ doit contenir une <strong>adresse textuelle</strong> (ex: "2 plateaux, Cocody, Abidjan"). 
            Cette adresse s'affichera dans le footer et sous la carte sur le site.
            <strong class="text-danger">PAS un lien Google Maps ou un code iframe</strong>.
          </div>
          <span asp-validation-for="Adresse" class="text-danger small"></span>
        </div>

        <div class="col-12 mt-4">
          <h5 class="fw-bold mb-3">
            <i class="bi bi-map me-2" style="color: #FF6B35;"></i>Carte interactive
          </h5>
        </div>

        <div class="col-12">
          <div class="form-check form-switch mb-3">
            <input class="form-check-input" type="checkbox" asp-for="AfficherCarte" id="afficherCarte" style="width: 3rem; height: 1.5rem; cursor: pointer;" />
            <label class="form-check-label fw-bold" for="afficherCarte">
              <i class="bi bi-map-fill me-2"></i>Afficher la carte sur le site
            </label>
            <div class="form-text">
              Activez cette option pour afficher une carte interactive avec votre localisation sur la page Contact.
            </div>
          </div>
        </div>

        <div class="col-12">
          <label class="form-label fw-bold">
            <i class="bi bi-code-square me-2"></i>Code iframe Google Maps <span class="text-muted small">(recommandé)</span>
          </label>
          <textarea asp-for="GoogleMapsIframe" class="form-control" rows="4" placeholder='&lt;iframe src="https://www.google.com/maps/embed?pb=..." width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"&gt;&lt;/iframe&gt;'></textarea>
          <div class="form-text">
            <i class="bi bi-lightbulb me-1"></i>
            <strong>Méthode recommandée :</strong> Collez ici le code iframe Google Maps de votre localisation. La carte s'affichera directement sur le site.
            <br/>
            <small>
              <strong>Comment obtenir le code iframe ?</strong><br/>
              1. Allez sur <a href="https://www.google.com/maps" target="_blank">Google Maps</a><br/>
              2. Recherchez votre adresse ou cliquez sur votre localisation<br/>
              3. Cliquez sur "Partager" → "Intégrer une carte" → "Copier le code HTML"<br/>
              4. Collez le code complet ici
            </small>
          </div>
          <span asp-validation-for="GoogleMapsIframe" class="text-danger small"></span>
        </div>

        @if (Model.AfficherCarte && Model.Latitude.HasValue && Model.Longitude.HasValue)
        {
          <div class="col-12">
            <div class="alert alert-success small">
              <i class="bi bi-check-circle me-2"></i>
              <strong>Coordonnées GPS détectées :</strong><br/>
              Latitude : @Model.Latitude.Value.ToString("F6")<br/>
              Longitude : @Model.Longitude.Value.ToString("F6")
            </div>
          </div>
        }

        <div class="col-12">
          <div class="alert alert-success small">
            <i class="bi bi-check-circle me-2"></i>
            <strong>Méthode recommandée :</strong> Utilisez le code iframe Google Maps ci-dessus. La carte s'affichera directement sur votre site avec toutes les fonctionnalités de Google Maps (navigation, itinéraires, etc.).
          </div>
        </div>

        <div class="col-12 mt-4">
          <h3 class="h5 fw-bold mb-3">
            <i class="bi bi-bar-chart me-2" style="color: #FF6B35;"></i>Statistiques page d'accueil
          </h3>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Années d'expérience</label>
          <input asp-for="AnneesExperience" class="form-control" placeholder="+10" />
          <small class="text-muted">Ex: +10, 15+, etc.</small>
          <span asp-validation-for="AnneesExperience" class="text-danger small"></span>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Projets réalisés</label>
          <input asp-for="ProjetsRealises" class="form-control" placeholder="500+" />
          <small class="text-muted">Ex: 500+, 1000, etc.</small>
          <span asp-validation-for="ProjetsRealises" class="text-danger small"></span>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Satisfaction client</label>
          <input asp-for="SatisfactionClient" class="form-control" placeholder="100%" />
          <small class="text-muted">Ex: 100%, 98%, etc.</small>
          <span asp-validation-for="SatisfactionClient" class="text-danger small"></span>
        </div>

        <div class="col-12 mt-4">
          <h3 class="h5 fw-bold mb-3">
            <i class="bi bi-share me-2" style="color: #FF6B35;"></i>Réseaux sociaux <small class="text-muted fw-normal">(optionnel - remplir uniquement ceux que vous souhaitez afficher)</small>
          </h3>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-facebook me-2"></i>Facebook
          </label>
          <input asp-for="FacebookUrl" type="text" class="form-control" placeholder="https://facebook.com/..." />
          <span asp-validation-for="FacebookUrl" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-linkedin me-2"></i>LinkedIn
          </label>
          <input asp-for="LinkedInUrl" type="text" class="form-control" placeholder="https://linkedin.com/..." />
          <span asp-validation-for="LinkedInUrl" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-twitter-x me-2"></i>Twitter / X
          </label>
          <input asp-for="TwitterUrl" type="text" class="form-control" placeholder="https://twitter.com/... ou https://x.com/..." />
          <span asp-validation-for="TwitterUrl" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-instagram me-2"></i>Instagram
          </label>
          <input asp-for="InstagramUrl" type="text" class="form-control" placeholder="https://instagram.com/..." />
          <span asp-validation-for="InstagramUrl" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-youtube me-2"></i>YouTube
          </label>
          <input asp-for="YouTubeUrl" type="text" class="form-control" placeholder="https://youtube.com/..." />
          <span asp-validation-for="YouTubeUrl" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-tiktok me-2"></i>TikTok
          </label>
          <input asp-for="TikTokUrl" type="text" class="form-control" placeholder="https://tiktok.com/..." />
          <span asp-validation-for="TikTokUrl" class="text-danger small"></span>
        </div>

        <div class="col-12 mt-4">
          <h3 class="h5 fw-bold mb-3">
            <i class="bi bi-palette me-2" style="color: #FF6B35;"></i>Personnalisation des couleurs
          </h3>
          <p class="text-muted small mb-3">Personnalisez les couleurs principales de votre site. Les couleurs seront appliquées immédiatement après sauvegarde.</p>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-circle-fill me-2" style="color: @(Model.CouleurPrimaire ?? "#FF6B35");"></i>Couleur primaire
          </label>
          <div class="input-group">
            <input type="color" asp-for="CouleurPrimaire" class="form-control form-control-color" value="@(Model.CouleurPrimaire ?? "#FF6B35")" title="Choisir la couleur primaire" />
            <input type="text" asp-for="CouleurPrimaire" class="form-control" placeholder="#FF6B35" pattern="^#[0-9A-Fa-f]{6}$" />
          </div>
          <div class="mt-2 p-2 bg-light rounded small">
            <strong>Utilisée pour :</strong>
            <ul class="mb-0 ps-3">
              <li>Boutons principaux (CTA)</li>
              <li>Liens de navigation</li>
              <li>Éléments d'action importants</li>
              <li>Bordures de focus</li>
            </ul>
          </div>
          <span asp-validation-for="CouleurPrimaire" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-circle-fill me-2" style="color: @(Model.CouleurSecondaire ?? "#E63946");"></i>Couleur secondaire
          </label>
          <div class="input-group">
            <input type="color" asp-for="CouleurSecondaire" class="form-control form-control-color" value="@(Model.CouleurSecondaire ?? "#E63946")" title="Choisir la couleur secondaire" />
            <input type="text" asp-for="CouleurSecondaire" class="form-control" placeholder="#E63946" pattern="^#[0-9A-Fa-f]{6}$" />
          </div>
          <div class="mt-2 p-2 bg-light rounded small">
            <strong>Utilisée pour :</strong>
            <ul class="mb-0 ps-3">
              <li>Boutons secondaires</li>
              <li>Badges et étiquettes</li>
              <li>Éléments de mise en évidence</li>
              <li>Gradients et effets visuels</li>
            </ul>
          </div>
          <span asp-validation-for="CouleurSecondaire" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-circle-fill me-2" style="color: @(Model.CouleurAccent ?? "#1E88E5");"></i>Couleur d'accent
          </label>
          <div class="input-group">
            <input type="color" asp-for="CouleurAccent" class="form-control form-control-color" value="@(Model.CouleurAccent ?? "#1E88E5")" title="Choisir la couleur d'accent" />
            <input type="text" asp-for="CouleurAccent" class="form-control" placeholder="#1E88E5" pattern="^#[0-9A-Fa-f]{6}$" />
          </div>
          <div class="mt-2 p-2 bg-light rounded small">
            <strong>Utilisée pour :</strong>
            <ul class="mb-0 ps-3">
              <li>Titres et sous-titres (h1, h2, h3)</li>
              <li>Liens hypertexte</li>
              <li>Icônes importantes</li>
              <li>Footer et sections d'accentuation</li>
            </ul>
          </div>
          <span asp-validation-for="CouleurAccent" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">
            <i class="bi bi-circle-fill me-2" style="color: @(Model.CouleurOr ?? "#dbb438");"></i>Couleur or
          </label>
          <div class="input-group">
            <input type="color" asp-for="CouleurOr" class="form-control form-control-color" value="@(Model.CouleurOr ?? "#dbb438")" title="Choisir la couleur or" />
            <input type="text" asp-for="CouleurOr" class="form-control" placeholder="#dbb438" pattern="^#[0-9A-Fa-f]{6}$" />
          </div>
          <div class="mt-2 p-2 bg-light rounded small">
            <strong>Utilisée pour :</strong>
            <ul class="mb-0 ps-3">
              <li>Éléments premium/vip</li>
              <li>Highlights et promotions</li>
              <li>Éléments de distinction</li>
              <li>Badges spéciaux</li>
            </ul>
          </div>
          <span asp-validation-for="CouleurOr" class="text-danger small"></span>
        </div>

        <div class="col-12 mt-3">
          <div class="alert alert-info small">
            <i class="bi bi-info-circle me-2"></i>
            <strong>Note :</strong> Les paragraphes et textes utilisent la couleur de texte par défaut du thème (noir en mode jour, blanc en mode nuit). Les couleurs personnalisées s'appliquent principalement aux éléments interactifs et de mise en forme.
          </div>
        </div>

        <div class="col-12 mt-4">
          <h3 class="h5 fw-bold mb-3">
            <i class="bi bi-sun-moon me-2" style="color: #FF6B35;"></i>Mode d'affichage
          </h3>
        </div>

        <div class="col-12">
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" asp-for="ModeSombre" id="modeSombre" style="width: 3rem; height: 1.5rem; cursor: pointer;" />
            <label class="form-check-label fw-bold" for="modeSombre">
              <i class="bi bi-moon-stars-fill me-2"></i>Mode nuit
              <span class="badge bg-secondary ms-2" id="modeStatus">Actuellement: <i class="bi bi-sun-fill"></i> Mode jour</span>
            </label>
            <div class="form-text">
              <strong>Mode jour</strong> : Thème clair par défaut, idéal pour une utilisation en journée.<br/>
              <strong>Mode nuit</strong> : Thème sombre pour un confort visuel optimal, notamment en faible luminosité ou le soir.
            </div>
          </div>
        </div>

        <div class="col-12 mt-4">
          <h3 class="h5 fw-bold mb-3">
            <i class="bi bi-search me-2" style="color: #FF6B35;"></i>SEO (Référencement)
          </h3>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Titre SEO par défaut</label>
          <input asp-for="SeoTitleDefaut" class="form-control" placeholder="Titre par défaut pour les pages" />
          <small class="text-muted">Utilisé si non spécifié sur une page</small>
          <span asp-validation-for="SeoTitleDefaut" class="text-danger small"></span>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Description SEO par défaut</label>
          <textarea asp-for="SeoDescriptionDefaut" class="form-control" rows="2" placeholder="Description par défaut pour les pages"></textarea>
          <small class="text-muted">Utilisée si non spécifiée sur une page</small>
          <span asp-validation-for="SeoDescriptionDefaut" class="text-danger small"></span>
        </div>
      </div>

      <div class="col-12 mt-4">
        <h3 class="h5 fw-bold mb-3">
          <i class="bi bi-info-circle me-2" style="color: #FF6B35;"></i>Contenu de la page "À propos"
        </h3>
        <p class="text-muted small mb-3">Personnalisez le contenu de la page "À propos" de votre site.</p>
      </div>

      <div class="col-12">
        <label class="form-label fw-bold">Texte de la section "Notre Histoire"</label>
        <textarea asp-for="TexteHistoire" class="form-control" rows="6" placeholder="Décrivez l'histoire de votre entreprise, sa mission, sa vision et ses valeurs..."></textarea>
        <small class="text-muted">Ce texte remplacera le texte par défaut dans la section "Notre Histoire" de la page À propos. Laissez vide pour utiliser le texte par défaut.</small>
        <span asp-validation-for="TexteHistoire" class="text-danger small"></span>
      </div>

      <div class="col-12 mt-4">
        <h4 class="h6 fw-bold mb-3">Personnalisation des valeurs</h4>
        <p class="text-muted small mb-3">Personnalisez les descriptions des 4 valeurs affichées sur la page À propos.</p>
      </div>

      <div class="col-md-6">
        <label class="form-label fw-bold">
          <i class="bi bi-star-fill me-2" style="color: #FF6B35;"></i>Excellence
        </label>
        <textarea asp-for="TexteValeurExcellence" class="form-control" rows="3" placeholder="Nous visons l'excellence dans chaque projet que nous entreprenons."></textarea>
        <small class="text-muted">Description de la valeur "Excellence"</small>
        <span asp-validation-for="TexteValeurExcellence" class="text-danger small"></span>
      </div>

      <div class="col-md-6">
        <label class="form-label fw-bold">
          <i class="bi bi-lightbulb-fill me-2" style="color: #FF6B35;"></i>Innovation
        </label>
        <textarea asp-for="TexteValeurInnovation" class="form-control" rows="3" placeholder="Nous adoptons les dernières technologies pour offrir des solutions modernes."></textarea>
        <small class="text-muted">Description de la valeur "Innovation"</small>
        <span asp-validation-for="TexteValeurInnovation" class="text-danger small"></span>
      </div>

      <div class="col-md-6">
        <label class="form-label fw-bold">
          <i class="bi bi-heart-fill me-2" style="color: #FF6B35;"></i>Engagement
        </label>
        <textarea asp-for="TexteValeurEngagement" class="form-control" rows="3" placeholder="Nous nous engageons à dépasser les attentes de nos clients."></textarea>
        <small class="text-muted">Description de la valeur "Engagement"</small>
        <span asp-validation-for="TexteValeurEngagement" class="text-danger small"></span>
      </div>

      <div class="col-md-6">
        <label class="form-label fw-bold">
          <i class="bi bi-shield-check-fill me-2" style="color: #FF6B35;"></i>Fiabilité
        </label>
        <textarea asp-for="TexteValeurFiabilite" class="form-control" rows="3" placeholder="Vous pouvez compter sur nous pour des solutions durables et fiables."></textarea>
        <small class="text-muted">Description de la valeur "Fiabilité"</small>
        <span asp-validation-for="TexteValeurFiabilite" class="text-danger small"></span>
      </div>

      <div class="mt-4 d-flex gap-2">
        <button class="btn btn-primary" type="submit">
          <i class="bi bi-check-circle me-2"></i>Sauvegarder les paramètres
        </button>
        <a class="btn btn-outline-secondary" href="/Admin/Dashboard">
          <i class="bi bi-arrow-left me-2"></i>Retour au dashboard
        </a>
      </div>
    </form>
  </div>
</div>

@section Scripts {
  <partial name="_ValidationScriptsPartial" />
  <script>
    // Synchronisation entre le sélecteur de couleur et le champ texte
    document.addEventListener('DOMContentLoaded', function() {
      const colorInputs = document.querySelectorAll('input[type="color"]');
      
      colorInputs.forEach(colorInput => {
        const textInput = colorInput.parentElement.querySelector('input[type="text"]');
        
        if (textInput) {
          // Quand la couleur change dans le sélecteur, mettre à jour le champ texte
          colorInput.addEventListener('input', function() {
            textInput.value = this.value.toUpperCase();
          });
          
          // Quand le texte change, mettre à jour le sélecteur (si valide)
          textInput.addEventListener('input', function() {
            if (/^#[0-9A-Fa-f]{6}$/.test(this.value)) {
              colorInput.value = this.value.toUpperCase();
            }
          });
          
          // Synchroniser au chargement
          if (textInput.value) {
            colorInput.value = textInput.value.toUpperCase();
          }
        }
      });
      
      // Mise à jour du badge pour le mode jour/nuit
      const modeToggle = document.getElementById('modeSombre');
      const modeStatus = document.getElementById('modeStatus');
      
      if (modeToggle && modeStatus) {
        function updateModeStatus() {
          if (modeToggle.checked) {
            modeStatus.innerHTML = 'Actuellement: <i class="bi bi-moon-stars-fill"></i> Mode nuit';
            modeStatus.className = 'badge bg-dark ms-2';
          } else {
            modeStatus.innerHTML = 'Actuellement: <i class="bi bi-sun-fill"></i> Mode jour';
            modeStatus.className = 'badge bg-warning text-dark ms-2';
          }
        }
        
        modeToggle.addEventListener('change', updateModeStatus);
        updateModeStatus(); // Initialiser au chargement
      }
      
    });
  </script>
}
